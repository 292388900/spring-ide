<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>

<!--
  this extension point is deprecated but since the hosting menu still uses it we
  have no choice (unless we convert to hosting menu and all contributions to the new
  mechanism  -->
 <!--disabled. Instead offer something simpler that only applies to a project's
     pom file and allows use to add a 'starter' from a list.
     -->
  <!--
   <extension
         point="org.eclipse.ui.popupMenus">
      <objectContribution
            objectClass="org.eclipse.core.resources.IProject"
            adaptable="true"
            id="org.springframework.ide.eclipse.beans.ui.actions.springProject">
         <visibility>
            <and>
		        <objectState
		              name="nature"
		              value="org.springframework.ide.eclipse.core.springnature">
		        </objectState>
		        <objectState
		              name="nature"
		              value="org.eclipse.m2e.core.maven2Nature">
		        </objectState>
            </and>
         </visibility>
         <action
               label="Edit Boot Starters"
               class="org.springframework.ide.eclipse.boot.ui.EditStartersAction"
               enablesFor="1"
               menubarPath="org.springframework.ide.eclipse.ui.tools/group0"
               id="org.springframework.ide.eclipse.boot.ui.EditStartersAction">
         </action>
      </objectContribution>
  </extension>
 -->
 
<!-- Create an 'Add Spring Starter' menu that applies to pom.xml file inside a
  spring boot project -->
  
  
 
  <!-- run as boot support -->
  
<extension
       point="org.eclipse.core.expressions.propertyTesters">
    <propertyTester
          class="org.springframework.ide.eclipse.boot.core.BootPropertyTester"
          id="org.springsource.ide.eclipse.boot.BootPropertyTester"
          namespace="org.springsource.ide.eclipse.boot"
          properties="isBootProject,isBootResource"
          type="org.eclipse.core.resources.IResource">
    <!--       type="java.lang.Object" -->
    </propertyTester>
 </extension>
 
   <!-- TODO this extension point won't allow us to provide discovery on a per project basis. So it isn't quite right but
        it is all we got for now so let's get something working and then fix that later -->
   <extension
         id="springBootExternalTypes"
         point="org.spring.ide.eclipse.completions.externaltypes">
      <typeSource
            class="org.springframework.ide.eclipse.boot.completions.SpringBootTypeDiscoveryFactory">
      </typeSource>
   </extension>
  
  

    <extension point="org.eclipse.ui.preferencePages">
	 	<page
         category="org.springsource.ide.eclipse.commons.preferencePage"
         class="org.springframework.ide.eclipse.boot.ui.preferences.BootInstallPreferencePage"
         id="org.springframework.ide.eclipse.boot.ui.preferences.BootInstallPreferencePage"
         name="Spring Boot">
   		</page>
   	</extension>
   	
   <extension
         point="org.eclipse.ui.popupMenus">
   	      <objectContribution
            objectClass="org.eclipse.core.resources.IProject"
            adaptable="true"
            id="com.springsource.sts.roo.ui.actions.rooProject">
         <visibility>
         	<!-- TODO: only allow this for spring boot projects? -->
	        <objectState
	              name="nature"
	              value="org.springframework.ide.eclipse.core.springnature">
	        </objectState>
         </visibility>
         <action
                   class="org.springframework.ide.eclipse.boot.ui.OpenLiveBeansGraphAction"
                   enablesFor="+"
                   icon="resources/icons/live-beans-graph.png"
                   id="org.springframework.ide.eclipse.boot.ui.OpenLiveBeansGraphAction"
                   label="Open Live Beans Graph"
                   menubarPath="org.springframework.ide.eclipse.ui.tools/group0">
         </action>
      </objectContribution>
   	</extension>

</plugin>
