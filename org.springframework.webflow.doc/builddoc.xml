<?xml version="1.0"?>

<!--
    Build file for the reference documentation of the Spring Framework.

    $Id: builddoc.xml 202 2005-03-27 21:35:31Z tjuerge $

    This script requires a "lib" directory containing the necessary third party JAR files.
    See build.properties for the definitions of the properties used in this file.
-->

<project name="spring-docs" default="usage" basedir=".">

	<property file="build.properties"/>

	<target name="usage">
		<echo message=""/>
		<echo message="spring-docs build file"/>
		<echo message="------------------------------------------------------"/>
		<echo message=""/>
		<echo message="Available targets:"/>
		<echo message=""/>
		<echo message="dochtml --> build HTML documentation"/>
		<echo message="docclean --> delete HTML documentation"/>
		<echo message=""/>
	</target>


	<target name="docclean" description="Delete temporary and distribution directories for docs">
		<delete quiet="true" dir="${basedir}/${dist.ref.dir}"/>
		<delete quiet="true" file="${basedir}/doc.zip"/>
		<delete quiet="true" file="${basedir}/toc.xml"/>
	</target>


	<target name="dochtml" description="Compile reference documentation to chunked html">
		<antcall target="docclean"/>

		<mkdir dir="${basedir}/${dist.ref.dir}"/>

		<copy file="${basedir}/styles/eclipse.xsl"
			  todir="${basedir}/${doc.ref.dir}/styles"/>

		<java classname="com.icl.saxon.StyleSheet" fork="true"
			  dir="${basedir}/${dist.ref.dir}">
			<classpath>
				<fileset dir="${basedir}/${doc.ref.dir}/lib">
					<include name="**/*.jar"/>
				</fileset>
			</classpath>
			<arg value="${basedir}/${doc.ref.dir}/src/index.xml"/>
			<arg value="${basedir}/${doc.ref.dir}/styles/eclipse.xsl"/>
		</java>

		<move file="${basedir}/${dist.ref.dir}/toc.xml"
			  todir="${basedir}"/>

		<zip destfile="${basedir}/doc.zip">
			<fileset dir="${basedir}/${doc.ref.dir}/src">
				<include name="images/*"/>
			</fileset>
			<fileset file="${basedir}/${doc.ref.dir}/styles/html.css"/>
			<fileset dir="${basedir}/${dist.ref.dir}" excludes="toc.xml"/>
		</zip>
	</target>

</project>
